<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRUOP</title>

    <link rel="stylesheet" href="/static/css/history.css">
    <link rel="stylesheet" href="/static/css/dashboard.css">

    <script src="/static/js/dashboard.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- gaugechart -->
</head>
<body>
    <!-- ì‚¬ì´ë“œë°” -->
    <div id="sidebar" class="sidebar">
        <ul>
            <li>
                <a href="#">íšŒì›ì •ë³´ ìˆ˜ì •</a>
            </li>
            <li>
                <a href="/templates/history.html">ì´ë ¥ ì¡°íšŒ</a>
            </li>
            <li>
                <a href="/templates/mystudy.html">ë‚´ìŠ¤í„°ë””</a>
            </li>
        </ul>
    </div>
    <!-- ì‚¬ì´ë“œë°” ë-->

    <!-- ì‚¬ì´ë“œë°” ì™¸ ë³¸ë¬¸ ì‹œì‘ -->
    <div id="main">
        <button class="sidebar-btn" onclick="Sidebar_move()">â˜°</button>
    </div>
    <!-- ì‚¬ì´ë“œë°” ì™¸ ë³¸ë¬¸ ì‹œì‘ ë -->

    <!-- ìƒë‹¨ ë°”-->
    <header>
        <div class="logo">SROUP</div>
        <div>
            <button onclick="location.href='login.html';">ë¡œê·¸ì¸</button>
            <button onclick="location.href='create_group.html';">ê·¸ë£¹ìƒì„±</button>
            <button onclick="location.href='mypage.html';">ë§ˆì´í˜ì´ì§€</button>
            <button onclick="location.href='logout.html';">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </header>

    <!-- dashboard -->
    <div class="tab-container">
        <ul class="tabs">
            <li class="tab" data-tab="tab1">Group Board</li>
            <li class="tab" data-tab="tab2">My Board</li>
            <li class="tab" data-tab="tab3">Member</li>
        </ul>

        <div class="tab-content" id="tab1" >

        </div>
        <div class="tab-content" id="tab2">
            <div class="tab-study" id="tab2-1"> 
                <h2>STUDY TIMER</h2>
                <button class="timer-btn"> ON </button> 

            </div> 

            <div class="tab-study" id="tab2-2"> 
                <h2> ğŸ”” ì•Œë¦¼ </h2> 
            </div>
            <div class="popup-overlay"></div>
            <div class="popup" id="popup2">
                <h2>ì•Œë¦¼ </h2>
                <p> ì•Œë¦¼ ë‚´ìš© </p>
            </div>

            <div class="tab-study" id="tab2-3">
                <h2 id="write-tab"> íšŒê³ ë¡ âœï¸</h2> 
                <div class="date-navigation">
                    <button id="prev-date">&lt;</button>
                    <span id="current-date"> 0000.00.00 </span> 
                    <button id="next-date">&gt;</button>
                </div>
                <div class="study-content" id="study-content">
                    ì‘ì„±ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.
                </div>
            </div>

            <!-- íŒì—… ì½”ë“œ -->
            <div class="popup-overlay"></div>
            <div class="popup" id="popup3">
                <h2> íšŒê³ ë¡ </h2>
                <form>
                    <input type="text" id="title" placeholder="ì œëª©" required>
                    <p></p>
                    <textarea type="text" id="content" placeholder="ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" required> </textarea>
                    <button class="upload"> ë“±ë¡í•˜ê¸° </button>
                </form>
            </div>


            <div class="tab-study" id="tab2-4"> 
                <canvas id="gaugeChart" style="height: 40vh"></canvas>
            </div>
            
            
            <div class="tab-study" id="tab2-5"> ìˆ˜í–‰ë¥ </div>
            <div class="tab-study" id="tab2-6">
                <div>
                    <div class="calendar">
                        <div class="calendar-header">
                            <button id="prev-month">&lt;</button>
                            <h2 id="month-year"></h2>
                            <button id="next-month">&gt;</button>
                        </div>
                        <div class="calendar-days">
                            <div>ì¼</div>
                            <div>ì›”</div>
                            <div>í™”</div>
                            <div>ìˆ˜</div>
                            <div>ëª©</div>
                            <div>ê¸ˆ</div>
                            <div>í† </div>
                        </div>
                        <div class="days" id="days-content"></div>
                    </div>
                </div>
            </div>


            <div class="tab-study" id="tab2-7"> ë‹¬ì„±ë¥ </div>
            <img id="tab2-8" src="https://ghchart.rshah.org/082918"/>
        </div>

        <div class="tab-content" id="tab3">
            <p>ë©¤ë²„ëª…ë‹¨</p>
        </div>
    </div>  


<script>
    // ì•Œë¦¼ íŒì—… ì—´ê¸° 
    const popupOverlay = document.querySelector(".popup-overlay");
    
    const tab2writer = document.querySelector("#tab2-2") 
    const popup2 = document.querySelector("#popup2");

    tab2writer.addEventListener("click", () => {
    popupOverlay.style.display = "block"; // overlay ë°°ê²½ í‘œì‹œ 
    popup2.style.display = "block";       // íŒì—… í‘œì‹œ
    });
    
    // íšŒê³ ë¡ íŒì—… ì—´ê¸°
    const tab3writer = document.querySelector("#write-tab") 
    const popup3 = document.querySelector("#popup3");
    
    tab3writer.addEventListener("click", () => {
    popupOverlay.style.display = "block"; // overlay ë°°ê²½ í‘œì‹œ 
    popup3.style.display = "block";       // íŒì—… í‘œì‹œ
    });    

    // íŒì—… ë‹«ê¸° 
    const closePopup = () => {
    popupOverlay.style.display = "none"; // overlay ë°°ê²½ ìˆ¨ê¹€ 
    popup2.style.display = "none";     // ì•Œë¦¼ íŒì—… ë‹«ê¸°
    popup3.style.display = "none";     // íšŒê³ ë¡ íŒì—… ë‹«ê¸° 
    };

    popupOverlay.addEventListener("click", closePopup);   // overlay (ì°½ ë°– ë¶€ë¶„) í´ë¦­ ì‹œ íŒì—… ë‹«í˜ 

    // íšŒê³ ë¡ ë‚ ì§œ
    const currentDate = new Date(); // í˜„ì¬ ë‚ ì§œ 

    const currentDateElement = document.getElementById("current-date");
    const studycontent = document.getElementById("study-content") 
    const prevdate = document.getElementById("prev-date") 
    const nextdate = document.getElementById("next-date") 
    const popupdate = document.getElementById("popup-date");


    function formatDate(date) {
      return `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, "0")}.${String(date.getDate()).padStart(2, "0")}`;
    };

    const records = {}; 

    function updateDateDisplay() {
      currentDateElement.textContent = formatDate(currentDate);
      const recordKey = formatDate(currentDate);
      studycontent.textContent = records[recordKey] || "íšŒê³ ë¡ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.";
    };

    // ì´ì „ë‚ ì§œ íšŒê³ ë¡ 
    prevdate.addEventListener("click", ()=> {
        currentDate.setDate(currentDate.getDate() -1);
        updateDateDisplay();
    });

    // ì´í›„ë‚ ì§œ íšŒê³ ë¡
    nextdate.addEventListener("click", ()=> {
        currentDate.setDate(currentDate.getDate() +1);
        updateDateDisplay();
    });

    // ì‘ì„± ë²„íŠ¼
    const uploadbtn = document.querySelector(".upload");

    // íšŒê³ ë¡ ì‘ì„± ì‹œ ë‹¬ë ¥ì— í‘œì‹œ
    uploadbtn.addEventListener("click", (event) => {
    event.preventDefault();

    const title = document.getElementById("title").value;
    const content = document.getElementById("content").value;
    const recordKey = formatDate(currentDate);

    if (title && content) {
        // íšŒê³ ë¡ ë°ì´í„° ì €ì¥
        records[recordKey] = { title, content };

        alert("íšŒê³ ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
        closePopup(); // íŒì—… ë‹«ê¸°
        updateDateDisplay(); // íšŒê³ ë¡ ë‚´ìš© ê°±ì‹ 
        updateCalendar(currentDate); // ë‹¬ë ¥ ê°±ì‹ 
    } else {
        alert("ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    }
    });

    // íƒ€ì´ë¨¸ 
    var timerbtn = document.querySelector(".timer-btn")

    timerbtn.addEventListener("click", ()=> {
        const timerWindow = window.open(
        "studytimer.html", // íƒ€ì´ë¨¸ ì‹¤í–‰ (íƒ€ì´ë¨¸ html)
        "íƒ€ì´ë¨¸", // íƒ€ì´ë¨¸ë¡œ ì—´ ì°½ ì´ë¦„
        "width=400,height=300" // íƒ€ì´ë¨¸ ì°½ í¬ê¸° 
        )

        if (!timerWindow) {
        alert("íŒì—… ì°¨ë‹¨ì„ í•´ì£¼ì„¸ìš”! íƒ€ì´ë¨¸ ì°½ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        }
    });

    // ë‹¬ë ¥
    const calendarcontent = document.getElementById("days-content");
    const monthyear = document.getElementById("month-year");
    const prevmonth = document.getElementById("prev-month");
    const nextmonth = document.getElementById("next-month");

    // ë‹¬ë ¥ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateCalendar(date) {
        const year = date.getFullYear();
        const month = date.getMonth();

        monthyear.textContent = `${year}ë…„ ${month + 1}ì›”`;

        const firstDay = new Date(year, month, 1).getDay(); // ì´ë²ˆ ë‹¬ 1ì¼ì˜ ìš”ì¼
        const lastDate = new Date(year, month + 1, 0).getDate(); // ì´ë²ˆ ë‹¬ì˜ ë§ˆì§€ë§‰ ë‚ ì§œ

        calendarcontent.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

    // ë¹ˆ ì¹¸ ì¶”ê°€
        for (let i = 0; i < firstDay; i++) {
            const emptyDiv = document.createElement("div");
            emptyDiv.classList.add("empty");
            calendarcontent.appendChild(emptyDiv);
        }

    // ë‚ ì§œ ì¶”ê°€
        for (let day = 1; day <= lastDate; day++) {
            const dayDiv = document.createElement("div");
            dayDiv.textContent = day;

            const recordKey = `${year}.${String(month + 1).padStart(2, "0")}.${String(day).padStart(2, "0")}`;

            // íšŒê³ ë¡ ì‘ì„± ë‚ ì§œ
            if (records[recordKey]) {
                dayDiv.classList.add("has-record");
            }

            calendarcontent.appendChild(dayDiv);
        }

    };

    // ì´ì „ ë‹¬ ë²„íŠ¼
    prevmonth.addEventListener("click", () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        updateCalendar(currentDate);
    });

    // ë‹¤ìŒ ë‹¬ ë²„íŠ¼
    nextmonth.addEventListener("click", () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        updateCalendar(currentDate);
    });

    // ì´ˆê¸°í™”
    updateCalendar(currentDate);
    updateDateDisplay(); // íšŒê³ ë¡ ë‚ ì§œ ì´ˆê¸°í™”


    // ì¶œì„ë¥  ì°¨íŠ¸ 
    var data = {
        value: 70,
        max: 100,
        label: "ì¶œì„ë¥ "
    };
    
    var chartCtx = document.getElementById('gaugeChart').getContext('2d');

    var config = {
        type: 'doughnut',
        data: {
            labels: [data.label],
            datasets: [{
                data: [data.value, data.max - data.value],
                backgroundColor: ['#f0e53c', 'rgba(0, 0, 0, 0.1)'],
                borderWidth: 0
            }]
        },

        options: {
            responsive: true, // ì°¨íŠ¸ ë°˜ì‘í˜• ì—¬ë¶€ ì„¤ì • 
            //maintainAspectRatio: false, // ê°€ë¡œì„¸ë¡œ ë¹„ìœ¨ ìœ ì§€ X
            cutoutPercentage: 85, // ë„ë„›í˜• ì°¨íŠ¸ ê°€ìš´ë° ë¹„ì–´ìˆëŠ” í¬ê¸° ì„¤ì • 
            rotation: -90, 
            circumference: 180, 
            animation: {
                animateRotate: true,
                animateScale: false
            },
            title: {
                display: true,
                text: data.label,
                fontSize: 16
            }}
            
        };

        var gaugeChart = new Chart(chartCtx, config);

</script>

</body>

</html>
